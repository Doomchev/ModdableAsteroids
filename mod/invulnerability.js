import Mod from "./mod.js"
import {apsk} from "../src/system.js"
import {project, val} from "../src/project.js"

let instance

export default class Invulnerability extends Mod {
    constructor(blinkingSpeed) {
        super()
        this.time = 0
        this.blinkingSpeed = blinkingSpeed
        instance = this
    }

    get name() {
        switch (project.locale) {
            case "ru":
                return "Неуязвимость"
            default:
                return "Invulnerability"
        }
    }

    update() {
        if(!val.invulnerable) return
        if(this.time <= 0) {
            val.shipLayer.visible = true
            val.invulnerable = false
            return
        }
        val.shipLayer.visible = ((this.time / this.blinkingSpeed) % 2) > 1
        this.time -= apsk
    }
}

export function makeInvulnerable(time) {
    instance.time = time
    val.invulnerable = true
}